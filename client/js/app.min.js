angular.module("genius-urban-youtube-app",["ngMaterial"]).controller("baseController",["$scope","$rootScope","$http","artistSongsService","$interval","$mdDialog",function($scope,$rootScope,$http,artistSongsService,$interval,$mdDialog){$rootScope.toSpin=!1,$scope.queryArtistSongs=function(){$rootScope.toSpin=!0,artistSongsService($scope.youtubeUrlMusicClip)},$scope.showAlert=function(ev,verse){var annotation=findAnnotationById(verse.id);annotation&&$mdDialog.show($mdDialog.alert().theme("docs-dark").title(verse.content).content(annotation).ariaLabel("Password notification").ok("Got it!").targetEvent(ev))};var findAnnotationById=function(id){return $rootScope.lyricsAndExplanations.explanations[id]}}]).factory("artistSongsService",["$rootScope","$http","$window",function($rootScope,$http){return function(youtubeUrlMusicClip){if(void 0===youtubeUrlMusicClip&&""===youtubeUrlMusicClip)return void($rootScope.toSpin=!1);var indexOfId=youtubeUrlMusicClip.indexOf("v=");if(-1==indexOfId)return $rootScope.toSpin=!1,$rootScope.doFail=!0,void($rootScope.failExplanation="The url you pasted might not be well formatted, please copy and past raw urls directly from YouTube.com");$rootScope.doFail=!1;var youtubeVideoId,indexAnd;return youtubeVideoId=-1==(indexAnd=youtubeUrlMusicClip.indexOf("&"))?youtubeUrlMusicClip.substring(indexOfId+2):youtubeUrlMusicClip.substring(indexOfId+2,indexAnd),void 0===youtubeVideoId?($rootScope.toSpin=!1,$rootScope.doFail=!0,void($rootScope.failExplanation="Unknow Problem, feel free to report this issue on Twitter @Acen_1991")):($rootScope.doFail=!1,void $http.post("/retrievelyricsFromYoutubeId",{youtubeVideoId:youtubeVideoId}).success(function(data){data.error?($rootScope.doFail=!0,$rootScope.failExplanation=data.explanation):($rootScope.doFail=!1,$rootScope.lyricsAndExplanations=data.lyricsAndExplanations),$rootScope.toSpin=!1}).error(function(data,status){console.log(status),$rootScope.doFail=!1,$rootScope.failExplanation=status,$rootScope.toSpin=!1}))}}]).config(function($mdThemingProvider){$mdThemingProvider.theme("docs-dark","default").primaryPalette("yellow").dark()}).filter("normalizeFilter",function(){return function(text){return void 0!==text?text.trim():text}});